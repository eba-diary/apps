@using Sentry.data.Web;
@model DaleSearchModel

@{
    ViewBag.Title = "Data Inventory";
    ViewBag.Fluid = true;
}

<!-- Top Search Row -->
<div class="row di-horizontal-center">
    <div class="di-search-head">
        <div class="di-head-item"><img src="~/Images/Dale/DataInventoryIcon.png" class="di-img leftFloat" /></div>
        <div class="di-head-item"><h1 class="htCenter datasetHeader">Data Inventory</h1></div>

        <div id="di-search-box" class="has-feedback has-feedback-left">
            <input class="form-control searchTextDS text-box single-line" type="text" id="inventorySearchText" placeholder="Search Data Inventory" value="@Model.Criteria" />
            <i class="form-control-feedback glyphicon glyphicon-search clickable" data-bind="click: {}"></i>
            <i class="form-control-feedback fa fa-circle-o-notch fa-spin hidden"></i>
        </div>
    </div>
</div>

<!-- Body Row -->
<div class="row di-body">
    <!-- Left Pane - Filters() -->
    <div class="hidden-xs hidden-sm col-md-3" id="search-pg-filters">
        <div id="filterColumn" class="display-none">
            <!-- ko foreach: { data: FilterCategories, as: 'category' } -->
            <div class="panel panel-default filters-pane">
                <div class="panel-heading filterHead" data-bind="attr: { id: category.HeadId }">
                    <span class="filterCategoryName" data-bind="text: category.Name"></span>
                    <span class="glyphicon glyphicon-chevron-down rightFloat filterViewIcon" data-bind="attr: { id: category.HeadIcon }"></span>
                </div>

                <div class="filters-category panel-body display-none" data-bind="attr: {id : category.HeadHide }">
                    <!-- ko foreach: { data: category.FilterCategoryOptions, as: 'option' } -->
                    <ul class="list-unstyled ul-filter-list">
                        <li class="list-unstyled li-filter-disabled filterList" data-bind="visible: $index() < 6, css: { notAllowed: option.Count == 0 }">
                            <label data-bind="attr: { id: option.id }">
                                <input type="checkbox" class="filterChbx" data-bind="value: option.id, checked: option.DefaultSelected, attr: { id: option.id, disabled: option.Count == 0 }" />
                                <strong data-bind="text: option.Title"></strong>
                                <span class="filter-tile-count">(<!--ko text: option.Count--><!--/ko-->)</span>
                            </label>
                        </li>

                        <li data-bind="attr: { id : category.HiddenMore }">
                            <ul class="notNested">
                                <li class="list-unstyled li-filter-disabled filterList" data-bind="visible: $index() >= 6, css: { notAllowed: option.Count == 0 }">
                                    <label data-bind="attr: { id: option.id }">
                                        <input type="checkbox" class="filterChbx" data-bind="value: option.id, checked: option.DefaultSelected, attr: { id: option.id, disabled: option.Count == 0 }" />
                                        <strong data-bind="text: option.Title"></strong>
                                        <span class="filter-tile-count">(<!--ko text: option.Count--><!--/ko-->)</span>
                                    </label>
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <!-- /ko -->

                    <!-- ko if: (category.FilterCategoryOptions.length > 6) -->
                    <a href="#" class="filterMore" data-bind="attr: { id: category.HiddenId}">
                        <div class="glyphicon glyphicon-plus-sign inlineBlock moreIcon leftFloat" data-bind="attr: { id: category.IconMore }"></div>
                        <div class="leftFloat txt_filterMore" data-bind="attr: { id: category.TxtMore }">Show More</div>
                    </a>
                    <!-- /ko -->

                </div>
            </div>

            <!-- /ko -->
        </div>
    </div>

    <!-- Body - Active Filters & Results -->
    <div class="col-sm-12 col-md-9">
        <div>
            <h4 class="found">
                Active Filters:
                <button type="button" class="btn btn-sm btn-primary" id="btnClearFilters" data-bind="">Clear Filters</button>
            </h4>

            <select multiple="" class="form-control select2-hidden-accessible" id="filterSelector" name="filterSelector" tabindex="-1" aria-hidden="true" data-bind="foreach: { data: FilterCategories, as: 'category' }">
                <optgroup data-bind="attr: {label: category.Name}, foreach: { data: category.FilterCategoryOptions, as: 'option' }">
                    <option data-bind="value: option.id, text: option.Title"></option>
                </optgroup>
            </select>
        </div>

        <div id="di-result-spinner" class="sentry-spinner-container vertCenter">
            <span class="sentry-spinner"></span>
        </div>

        @Html.Partial("~/Views/Dale/DaleResult.cshtml", Model)
    </div>
</div>

@section Scripts
{
    @Scripts.Render("~/bundles/dataTables")
    <script type="text/javascript">

        $(function () { data.DataInventory.init(); });

    </script>
}