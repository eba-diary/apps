@model HomeModel
@{
    ViewData["Title"] = "Data at Sentry";
    Layout = "~/Views/Shared/_HomePageLayout.cshtml";
}


<div class="container body-content">

    <div class="row">

        @* left column for the tiles *@
        <div class="col-xs-12 col-sm-7 col-md-9 col-lg-9">

            @* row for the first Business Intelligence (spans entire row) *@
            <div class="row">

                <div id="bi-wrapper" class="col-xs-12 col-sm-12 col-md-11 col-lg-11">
                    <h2>Business Intelligence</h2>
                    <div class="home-photo bg-photo-bi border-btm-blue"></div>
                    <div id="bi-content-wrapper" class="home-tile">
                        <p>
                            Lorem Ipsum is simply dummy text of the printing and typesetting industry.
                            Lorem Ipsum has been the industry's standard dummy text ever since the 1500s,
                            when an unknown printer took a galley of type and scrambled it to make a type
                            specimen book.
                        </p>
                        <a href="/BusinessIntelligence" class="home-tile-link-bi">View Business Intelligence &gt;</a>
                    </div>
                </div>

            </div>

            <p>&nbsp;</p>

            @* second row for Datasets and Data Assets *@
            <div class="row">

                <div id="ds-wrapper" class="col-xs-12 col-sm-12 col-md-5 col-lg-5">
                    <h2 class="green">Datasets</h2>
                    <div class="home-photo bg-photo-ds border-btm-green"></div>
                    <div id="ds-content-wrapper" class="home-tile">
                        <p>
                            Contrary to popular belief, Lorem Ipsum is not simply random text. It has roots
                            in a piece of classical Latin literature from 45 BC, making it over 2000 years old.
                        </p>
                        <a href="/Dataset" class="home-tile-link-ds">View Datasets &gt;</a>
                    </div>
                </div>

                <div class="col-xs-12 col-sm-1 col-md-1 col-lg-1"></div>

                <div id="da-wrapper" class="col-xs-12 col-sm-12 col-md-5 col-lg-5">
                    <h2 class="plum">Data Assets</h2>
                    <div class="home-photo bg-photo-da border-btm-plum"></div>
                    <div id="da-conent-wrapper" class="home-tile">
                        <p>
                            There are many variations of passages of Lorem Ipsum available, but the majority have
                            suffered alteration in some form, by injected humour, or randomised words which don't
                            look even slightly believable. If you are going to use a passage of Lorem Ipsum, you
                            need to be sure there isn't anything embarrassing hidden in the middle of text.
                        </p>
                        <a href="/DataAsset/Index" class="home-tile-link-da">View Data Assets &gt;</a>
                    </div>
                </div>

            </div>

        </div>

        <div class="col-xs-12 col-sm-5 col-md-3 col-lg-3">

            <h2 class="float-l">My Favorites</h2>
            <div id="edit-favorites-icon" class="float-r clickable" data-toggle="tooltip" data-placement="top" title="Edit Favorites"><span class="glyphicon glyphicon-pencil"></span></div>
            <div class="border-btm-blue clearFloat"></div>

            <div id="favoritePanel">
                <div class="favoriteSpinner text-center">
                    <span class="sentry-spinner"></span>
                </div>
            </div>


            @* commenting out feed until there's a better home for it
                <h2 class="green">Feed</h2>
                <div class="border-btm-green"></div>

                <div id="feed" class="feedBox">
                    <div class="feedSpinner text-center">
                        <span class="sentry-spinner"></span>
                    </div>
                </div>
            *@

            @* is this needed??
                <div class="feedBox clearFloat hidden" id="sentryFeed"></div>
            *@

        </div>

    </div>

</div>

@section Scripts {
    <script>
        $(function () {
            data.Home.Init();
            data.Dataset.IndexInit();

            $('.browse-category-card').click(function (e) {
                var storedNames = JSON.parse(localStorage.getItem("filteredIds"));

                if (storedNames != null) {
                    for (i = 0; i < storedNames.length; i++) {
                        $('#' + storedNames[i]).prop('checked', false);
                    }

                    localStorage.removeItem("filteredIds");
                }

                localStorage.removeItem("searchText");
            });

            $('#DatasetSearch').click(function (e) {
                localStorage.removeItem("filteredIds");

                localStorage.removeItem("searchText");

                localStorage.setItem("searchText", $('#SearchText')[0].value);
            });

            $('.input-group-addon').click(function (e) {
                $('#DatasetSearch').submit();
            });

        });


        function GetFile(location) {

            $.ajax({
                url: '/ExternalFile/HasReadPermissions?pathAndFilename=' + encodeURIComponent(location),
                method: "GET",
                dataType: 'json',
                success: function (obj) {
                    if (obj.HasPermission) {
                        var url = '/ExternalFile/DownloadExternalFile?pathAndFilename=' + encodeURIComponent(location);
                        window.open(url);
                    }
                    else {
                        Sentry.ShowModalAlert(
                            "User does not have sufficient permissions to selected file."
                        );
                    }
                },
                error: function (obj) {
                    Sentry.ShowModalAlert("Failed permissions check, please try again.  If problem persists, please contact <a mailto:DSCSupport@sentry.com>DSCSupport@sentry.com</a>");
                }
            });
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

    </script>
}