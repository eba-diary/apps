@model Sentry.data.Web.BaseDatasetModel

@{
    ViewBag.Title = "View Dataset Details";
    string color = Model.DatasetCategory.Color;
}

<div>
    <a href="@Url.Action("List", "Dataset")" class="backToList"><span class="glyphicon glyphicon-chevron-left"></span>Back to list</a>
    <div class="categoryBanner-@color categoryBannerSml rightFloat hidden-md hidden-lg">@Model.DatasetCategory.Name</div>

    <div class="relative hidden-sm hidden-xs">
        <div class="category-type-wrap-detail bg_gray BG_@color">
            <div class="category-type-detail categoryBanner-@color">
                @Model.DatasetCategory.Name
            </div>

            <div class="no-overflow">
                <h1 class="detailName leftFloat @color">
                    @Model.DatasetName

                    @if (Model.IsSensitive)
                    {
                        <span class="glyphicon glyphicon-lock lockIcon" data-toggle="tooltip" data-placement="top" title="Secure"></span>
                    }
                </h1>

                @{
                    foreach (string item in Model.DistinctFileExtensions())
                    {
                        <div class="extension detailExt bg_gray htCenter ext_@item">@item</div>
                    }
                }
                @*<div class="extension detailExt bg_gray htCenter ext_@Model.FileExtensionDisplay()">@Model.FileExtensionDisplay()</div>*@

                @if (Model.CanUpload)
                {
                    <button type="button" class="btn btn-default dataset-operation-button rightFloat borderdk_gray borderdk_@color" id="UploadModal" data-id="@Model.DatasetId" data-toggle="tooltip" data-placement="top" title="Upload File">
                        <span class="glyphicon glyphicon-cloud-upload @color"></span>
                    </button>
                }

                @if (Model.CanEditDataset)
                {
                    <button type="button" class="btn btn-default btn dataset-operation-button rightFloat borderdk_gray borderdk_@color" id="EditDataset_@Model.DatasetId" data-id="@Model.DatasetId" data-toggle="tooltip" data-placement="top" title="Edit Dataset">
                        <span class="glyphicon glyphicon-edit @color"></span>
                    </button>
                }

                @if ((Model.IsSensitive && Model.CanDwnldSenstive) || (!Model.IsSensitive && Model.CanDwnldNonSensitive))
                {
                    <button type="button" class="btn btn-default btn dataset-operation-button rightFloat borderdk_gray borderdk_@color" id="DownloadLatest" data-id="@Model.DatasetId" data-toggle="tooltip" data-placement="top" title="Download Latest">
                        <span class="glyphicon glyphicon-cloud-download @color"></span>
                    </button>
                }
                               
                @if ((Model.IsSensitive && Model.CanDwnldSenstive) || (!Model.IsSensitive && Model.IsPreviewCompatible))
                {
                    <button type="button" class="btn btn-default dataset-operation-button rightFloat borderdk_gray borderdk_@color" id="PreviewLatestData" data-id="@Model.DatasetId" data-toggle="tooltip" data-placement="top" title="Preview Latest">
                        <span class="glyphicon glyphicon-search @color"></span>
                    </button>
                }
            </div>
        </div>
    </div>

    <div class="hidden-md hidden-lg">
        <h1 class="detailNameSml leftFloat @color BG_@color text-center">@Model.DatasetName</h1>

        <div class="clearFloat leftFloat iconExt">
            @if (Model.IsSensitive)
            {
                <div class="glyphicon glyphicon-lock lockIconSml leftFloat" data-toggle="tooltip" data-placement="top" title="Secure"></div>
            }
            <div class="extension detailExtSml bg_gray htCenter ext_@Model.FileExtensionDisplay()">@Model.FileExtensionDisplay()</div>
        </div>

        @if (Model.CanEditDataset)
        {
            <button type="button" class="btn btn-default btn dataset-operation-button borderdk_gray borderdk_@color rightFloat" id="EditDataset_@Model.DatasetId" data-id="@Model.DatasetId" data-toggle="tooltip" data-placement="top" title="Edit Dataset">
                <span class="glyphicon glyphicon-edit @color"></span>
            </button>
        }

        @if ((Model.IsSensitive && Model.CanDwnldSenstive) || (!Model.IsSensitive && Model.CanDwnldNonSensitive))
        {
            <button type="button" class="btn btn-default btn dataset-operation-button borderdk_gray borderdk_@color rightFloat" id="DownloadDataset_@Model.DatasetId" data-id="@Model.DatasetId" data-toggle="tooltip" data-placement="top" title="Download Latest">
                <span class="glyphicon glyphicon-cloud-download @color"></span>
            </button>
        }

        @if ((Model.IsSensitive && Model.CanDwnldSenstive && Model.IsPreviewCompatible) || (!Model.IsSensitive && Model.IsPreviewCompatible))
        {
            <button type="button" class="btn btn-default dataset-operation-button borderdk_gray borderdk_@color rightFloat" id="PreviewData" data-id="@Model.DatasetId" data-toggle="tooltip" data-placement="top" title="Preview Latest">
                <span class="glyphicon glyphicon-search @color"></span>
            </button>
        }

    </div>

    <div class="detailDesc clearFloat">
        @Model.DatasetDesc
    </div>

    @if ((Model.IsSensitive && Model.CanDwnldSenstive) || (!Model.IsSensitive && Model.CanDwnldNonSensitive))
    {
        <div>
            <div id="detailSectionHeader_PushTo">
                <span class="glyphicon glyphicon-chevron-down element detailSectionHeader section_arrow_datafiles" id="icon_detailSectionHeader_PushTo"></span>
                <h2 class="detailSection @color">Push to BI Tools</h2>
                @*<h2 class="detailSection @color">Data Files <i>(Latest Versions)</i></h2>*@
            </div>
            <div id="hide_detailSectionHeader_PushTo">
                @if (Model.IsPushToSASCompatible)
                {
                    <button type="button" class="btn btn-default btn-sm dataset-pushto-button borderdk_gray borderdk_@color" id="Pushtofilename_@Model.DatasetId" data-id="@Model.DatasetId" data-toggle="tooltip" data-placement="bottom" title="Push Latest to SAS">
                        <img src="~/Images/sas_logo_rectangle.png" />
                    </button>
                }
                else
                {
                    <button type="button" class="btn btn-default btn-sm dataset-pushto-button disabled" data-toggle="tooltip" data-placement="bottom" title="Not available for this file type">
                        <img src="~/Images/sas_logo_rectangle.png" />
                    </button>
                }

                @*<button type="button" class="btn btn-default btn-sm dataset-pushto-button disabled" id="Pushtofilename_@Model.DatasetId" data-id="@Model.DatasetId" data-toggle="tooltip" data-placement="bottom" title="Not available for this file type">
                        <img src="~/Images/tableau-icon.png" />
                    </button>*@
            </div>
        </div>
    }   

    <div>
        <div id="detailSectionHeader_Metadata">
            <span class="glyphicon glyphicon-chevron-down element detailSectionHeader section_arrow_datafiles" id="icon_detailSectionHeader_Metadata"></span>
            <h2 class="detailSection @color">Metadata</h2>
            @*<h2 class="detailSection @color">Data Files <i>(Latest Versions)</i></h2>*@
        </div>        
        <div id="hide_detailSectionHeader_Metadata">
            <table class="table table-striped table-hover detailTable">
                <tbody>
                    <tr class="borderMeta_@color">
                        <td class="borderMeta_@color colOneMeta">Sentry Owner</td>
                        <td class="borderMeta_@color">@Model.SentryOwner.FullName</td>
                    </tr>
                    <tr>
                        <td class="borderMeta_@color colOneMeta">Creation Date</td>
                        <td class="borderMeta_@color">@Model.DatasetDtm</td>
                    </tr>
                    <tr>
                        <td class="borderMeta_@color colOneMeta">Category</td>
                        <td class="borderMeta_@color">@Model.DatasetCategory.Name</td>
                    </tr>
                    <tr>
                        <td class="borderMeta_@color colOneMeta" title="Root location is: \\sentry.com\appfs_nonprod\">DFS Drop Location</td>
                        <td class="borderMeta_@color">@Model.DropLocation</td>
                    </tr>
                    <tr>
                        <td class="borderMeta_@color colOneMeta">S3 Location</td>
                        <td class="borderMeta_@color">@Model.S3Key</td>
                    </tr>
                    <tr>
                        <td class="borderMeta_@color colOneMeta">Creation Frequency</td>
                        <td class="borderMeta_@color">@Model.CreationFreqDesc</td>
                    </tr>
                    <tr>
                        <td class="borderMeta_@color colOneMeta">Dataset Scope Type</td>
                        <td class="borderMeta_@color" title='@Model.DatasetScopeType.Description'>@Model.DatasetScopeType.Name</td>
                    </tr>
                    <tr>
                        <td class="borderMeta_@color colOneMeta">Number of Datafiles to Keep</td>
                        <td class="borderMeta_@color">@Model.DatafilesFilesToKeep</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    @*<div class="datasetdetail-datasetfileconfigs">
        @Html.Action("DatasetFileConfigs", "Dataset", new { datasetFileConfigModels = Model.DatasetFileConfigs })
    </div>*@
    @*<div>
        <h2 class="detailSection @color">Data Files</h2>

        <div id="DatasetItemList" class="dataset-list inlineBlock text-left">
            <ul class="list-unstyled">
                @{
                    foreach (var item in Model.DatasetFiles)
                    {
                        //<li>@item.FileName</li>
                        @Html.Partial("_ListDatasetFile", item)
                    }
                }
            </ul>
        </div>
    </div>*@
    <div>
        <div id="detailSectionHeader_DataFiles">
            <span class="glyphicon glyphicon-chevron-down element detailSectionHeader section_arrow_datafiles" id="icon_detailSectionHeader_DataFiles"></span>
            <h2 class="detailSection @color">Data Files <i>(Latest Versions)</i></h2>
            @*<h2 class="detailSection @color">Data Files <i>(Latest Versions)</i></h2>*@
        </div>
        <div id="hide_detailSectionHeader_DataFiles">
            @*<div id="userToolbar">
                <button id="bundle_last5" type="button" class="btn btn-link" title="Bundle Last 5"><img src="~/Images/icons/bundle.png" />Last 5</button>
                <button id="bundle_last10" type="button" class="btn btn-link" title="Bundle Last 10"><img src="~/Images/icons/bundle.png" />Last 10</button>
                <button id="bundle_last30" type="button" class="btn btn-link" title="Bundle Last 30"><img src="~/Images/icons/bundle.png" />Last 30</button>
                <button id="bundle_selected" type="button" class="btn btn-link" title="Bundle Selected Files"><img src="~/Images/icons/bundle.png" /></i>Selected Files</button>
            </div>*@

            <table class="table table-striped table-bordered @color" id="datasetFilesTable" width="90%">
                <thead>
                    @*<tr class="filter-row">
                        <td>Filter Id</td>
                        <td>Filter Name</td>
                        <td>Filter UploadUserName</td>
                        <td></td>
                    </tr>*@
                    <tr class="table-header_@color">
                        <th>Details</th>
                        <th>Actions</th>
                        <th>Name</th>
                        @*<th>Config File Name</th>*@
                        <th>Upload User Name</th>
                        <th>Initial Upload Date</th>
                        <th>Modified Date</th>
                    </tr>
                </thead>
                @*<tfoot>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                </tfoot>*@
                <tbody></tbody>
            </table>
        </div>
     </div>
    @{
        if (Model.CanManageConfigs)
        {
            <div>
                <div id="detailSectionHeader_DataFileConfigs">
                    <span class="glyphicon glyphicon-chevron-down element detailSectionHeader section_arrow_datafiles" id="icon_detailSectionHeader_DataFileConfigs"></span>
                    <h2 class="detailSection @color">Data File Configs</h2>
                </div>
                <div id="hide_detailSectionHeader_DataFileConfigs">
                    <table class="table table-striped table-bordered " id="datasetFileConfigsTable" width="90%">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Config File Name</th>
                                <th>Search Criteria</th>
                                <th>Target File Name</th>
                                <th>Regex Search</th>
                                <th>Overwrite Dataset File</th>
                                <th>Versions To Keep</th>
                                <th>File Type ID</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        }
    }

</div>



@*<script type="text/template" id="userTableRowIcons">
    <a href="#" class="table-row-icon datafile-download" title="Download"><i class="glyphicon glyphicon-cloud-download text-primary"></i></a>
    <a href="@Url.Action("EditUser")/{0}" class="table-row-icon" title="Edit User"><i class='glyphicon glyphicon-pencil text-primary'></i></a>
</script>*@


 <!--<div class="main-page-area">

    <img src="~/Images/Icons/DatasetsBlue.svg" class="datasetImg leftFloat" />
    <h2 class="detailHeader">Dataset Details</h2>

    <a href="@Url.Action("List", "Dataset", new { ldm = new ListDatasetModel() })" class="clearFloat leftFloat backToList"><span class="glyphicon glyphicon-chevron-left"></span> Back to list</a>

    <section class="dataset-detail-content clearFloat" id="Dataset-Detail-Name">
        @*<div class="dataset-detail-content-row" id="Dataset-Detail-Content-Label">
                @Html.Label("Name:")
            </div>*@
        <div class="dataset-detail-content-row" id="Dataset-Detail-Content-Value">
            <h2>
                @Html.DisplayFor(m => m.DatasetName)
            </h2>
        </div>
    </section>

    <section class="dataset-detail-content" id="Dataset-Detail-Name">
        @*@Html.ActionLink("Edit", "Edit", new { UniqueKey = Model.UniqueKey }) |
            @Html.ActionLink("Detail", "Detail", new { UniqueKey = Model.UniqueKey }) |
            @Html.ActionLink("Delete", "Delete", new { UniqueKey = Model.UniqueKey }) |*@
        @{
            if (Model.IsSensitive)
            {
                <i class="glyphicon glyphicon-lock text-primary" data-toggle="tooltip" data-placement="bottom" title="Secure"></i>
            }
        }

        @{
            if (Model.IsSensitive.Equals(false) || Model.CanDwnldSenstive)
            {
                <button type="button" class="btn btn-default btn-sm dataset-operation-button" id="DownloadDataset_@Model.DatasetId" data-id="@Model.DatasetId">
                    <span class="glyphicon glyphicon-cloud-download text-primary"></span> Download
                </button>
            }
        }
        @{
            if (Model.CanEditDataset)
            {
                <button type="button" class="btn btn-default btn-sm dataset-operation-button" id="EditDataset_@Model.DatasetId" data-id="@Model.DatasetId">
                    <span class="glyphicon glyphicon-edit text-primary"></span> Edit Details
                </button>
            }
        }
                
        @*<button type="button" class="btn btn-default btn-sm dataset-operation-button" id="DeleteDataset_@Model.Id" data-id="@Model.Id">
            <span class="glyphicon glyphicon-remove text-danger"></span> | Delete Dataset
        </button>*@
        <div>
            @* ...spacer... *@
            &nbsp; &nbsp;
        </div>
    </section>

    <section class="dataset-detail-content" id="Dataset-Detail-PushTo-Options">

        <div class="dataset-detail-content-row" id="Dataset-Detail-PushTo-Value">
            @{
                if (Model.IsPushToSASCompatible == true)
                {
                    <button type="button" class="btn btn-default btn-sm dataset-pushto-button" id="Pushtofilename_@Model.DatasetId" data-id="@Model.DatasetId" data-toggle="tooltip" data-placement="bottom" title="Push to SAS">
                        @*<img src="~/Images/sas_logo_rectangle.png" class="img-responsive" width="150" height="100" />*@
                        <img src="~/Images/sas_logo_rectangle.png" />
                    </button>
                }
                else
                {
                    <button type="button" class="btn btn-default btn-sm dataset-pushto-button" id="Pushtofilename_@Model.DatasetId" data-id="@Model.DatasetId" data-toggle="tooltip" data-placement="bottom" title="Push to SAS" disabled>
                        @*<img src="~/Images/sas_logo_rectangle.png" class="img-responsive" width="150" height="100" />*@
                        <img src="~/Images/sas_logo_rectangle.png" />
                    </button>
                }

            }

            @{
                <!--<button type="button" class="btn btn-default btn-sm dataset-pushto-button" id="Pushtofilename_@Model.DatasetId" data-id="@Model.DatasetId" data-toggle="tooltip" data-placement="bottom" title="Push to Tableau" disabled>
                    @*<img src="~/Images/tableau-icon.png" class="img-responsive" width="500" height="100" />*@
                    <img src="~/Images/tableau-icon.png"/>
                </button>-->
            }
        <!--</div>

        <div>
            @* ...spacer... *@
            &nbsp; &nbsp;
        </div>

    </section>

    <div class="form-group">
        @Html.LabelFor(model => model.DatasetDesc, htmlAttributes: new { @class = "control-label col-md-3"})
        <div class="col-md-9">
            <p>@Html.DisplayTextFor(model => model.DatasetDesc)</p>
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.SentryOwnerName, htmlAttributes: new { @class = "control-label col-md-3" })
        <div class="col-md-9">
            <p>@Html.DisplayTextFor(model => model.SentryOwnerName)</p>
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.UploadDtm, htmlAttributes: new { @class = "control-label col-md-3" })
        <div class="col-md-9">
            <p>@Html.DisplayTextFor(model => model.UploadDtm)</p>
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.ChangedDtm, htmlAttributes: new { @class = "control-label col-md-3" })
        <div class="col-md-9">
            <p>@Html.DisplayTextFor(model => model.ChangedDtm)</p>
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.Category, htmlAttributes: new { @class = "control-label col-md-3" })
        <div class="col-md-9">
            <p>@Html.DisplayTextFor(model => model.Category)</p>
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.S3Key, htmlAttributes: new { @class = "control-label col-md-3" })
        <div class="col-md-9">
            <p>@Html.DisplayTextFor(model => model.S3Key)</p>
        </div>
    </div>

    @*<section class="dataset-detail-content" id="Dataset-Detail-Metadata">
        <div class="dataset-detail-content-row">
            
            &nbsp; &nbsp;
        </div>
    </section>

    <section class="dataset-detail-content" id="Dataset-Column-Metadata">
        <div class="dataset-detail-content-row">
            @Html.Label("Column Metadata:")
        </div>
        <div class="dataset-detail-content-row">
            @if (Model != null && Model.Columns != null && Model.Columns.Count > 0)
            {
                <table>
                    @foreach (var md in Model.Columns)
                    {
                        <tr>
                            <td valign="middle">
                                @Html.Label(md.Name + ": ") &nbsp;
                            </td>
                            <td valign="middle">
                                @Html.DisplayFor(model => md.Value)
                            </td>
                        </tr>
                    }
                </table>
            }
            else
            {
                <p><i>No Metadata Available.</i></p>
            }
        </div>
    </section>

    <section class="dataset-detail-content" id="Dataset-Detail-Metadata">
        <div class="dataset-detail-content-row">
            @Html.Label("Additional Metadata:")
        </div>
        <div class="dataset-detail-content-row">
            @if (Model != null && Model.Metadata != null && Model.Metadata.Count > 0)
            {
                <table>
                    @foreach (var md in Model.Metadata)
                    {
                        <tr>
                            <td valign="middle">
                                @Html.Label(md.Name + ": ") &nbsp;
                            </td>
                            <td valign="middle">
                                @Html.DisplayFor(model => md.Value)
                            </td>
                        </tr>
                    }
                </table>
            }
            else
            {
                <p><i>No Metadata Available.</i></p>
            }
        </div>
    </section>*@

</div> -->

@section Scripts {

@Scripts.Render("~/bundles/dataTables")

    <script>
        var Id = @Model.DatasetId;
        $(function () {
            data.DatasetDetail.Init();
        });
    </script>
}
