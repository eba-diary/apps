@model Sentry.data.Web.DatasetAccessRequestModel

@{
    ViewData.TemplateInfo.HtmlFieldPrefix = "RequestAccess";
}

@using (Html.BeginForm("SubmitAccessRequestCLA3723", "Dataset", FormMethod.Post, new { @id = "AccessRequestForm" }))
{
    <div id="RequestAccessLoading" class="d-none text-center">
        <div class="preloader-wrapper big active">
            <div class="spinner-layer spinner-blue-only">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div>
                <div class="gap-patch">
                    <div class="circle"></div>
                </div>
                <div class="circle-clipper right">
                    <div class="circle"></div>
                </div>
            </div>
        </div>
    </div>
    <div id="RequestAccessBody">
        <ol class="breadcrumb p-0" id="RequestAccessBreadcrumb">
        </ol>
        <div id="RequestAccessToSection" class="requestAccessStage">
            <button id="RequestAccessToDatasetBtn" type="button" class="btn btn-default waves-effect waves-light requestAccessButton btn-block" value="@Model.SecurableObjectId">Request Access to <em id="RequestAccessDatasetName" class="font-style-normal">@Model.DatasetName Dataset</em></button>
            <button id="RequestAccessToAssetBtn" type="button" class="btn btn-default waves-effect waves-light requestAccessButton btn-block" value="@Model.SaidKeyCode">Request Access to all @Model.SaidKeyCode Datasets</button>
        </div>
        <div id="RequestAccessTypeSection" class="d-none requestAccessStage">
            <button id="RequestAccessTypeConsumeBtn" type="button" class="btn btn-default waves-effect waves-light requestAccessButton btn-block">Request Consumer/Query Access</button>
            <button id="RequestAccessTypeManageBtn" type="button" class="btn btn-default waves-effect waves-light requestAccessButton btn-block">Request Producer/Admin Access</button>
        </div>
        <div id="RequestAccessConsumerTypeSection" class="d-none requestAccessStage">
            <h6 class="pt-1">To Query in Snowflake UI, DSC, Tableau, or Superset:</h6>
            <button id="RequestAccessConsumeMyAccessBtn" type="button" onclick="window.open('https://myaccess.sentry.com/identityiq/accessRequest/accessRequest.jsf#/accessRequest/selectUser?quickLink=Request%20Access','_blank')" class="btn btn-default waves-effect waves-light requestAccessButton btn-block">Use MyAccess to Request <em id="RequestAccessConsumeEntitlement" class="font-style-normal"></em></button>
            <h6 class="pt-1">To Query from SageMaker or other AWS services:</h6>
            <button id="RequestAccessConsumeAwsBtn" type="button" class="btn btn-default waves-effect waves-light requestAccessButton btn-block">Request AWS IAM Access</button>
        </div>
        <div id="RequestAccessManageTypeSection" class="d-none requestAccessStage">
            <h6 class="pt-1">To Request Manage Access:</h6>
            <button id="RequestAccessManageMyAccessBtn" type="button" onclick="window.open('https://myaccess.sentry.com/identityiq/accessRequest/accessRequest.jsf#/accessRequest/selectUser?quickLink=Request%20Access','_blank')" class="btn btn-default waves-effect waves-light requestAccessButton btn-block">Use MyAccess to Request <em id="RequestAccessManageEntitlement" class="font-style-normal"></em></button>
        </div>
        <div id="RequestAccessFormSection" class="d-none requestAccessStage">
            <div class="alert alert-danger d-none" id="AccessRequestValidationMessage" role="alert">
                All fields are required.
            </div>
            <div class="alert alert-danger d-none" id="AccessRequestAwsArnValidationMessage" role="alert">
                AWS ARN must be properly formatted.
            </div>
            @Html.HiddenFor(m => m.Type)
            @Html.HiddenFor(m => m.Scope)
            @Html.HiddenFor(m => m.SecurableObjectId)
            <div class="md-form d-none" id="AwsArnForm">
                @Html.LabelFor(model => model.AwsArn, new { @class = "" })
                @Html.TextBoxFor(model => model.AwsArn, new { @class = "form-control" })
            </div>
            <div class="md-form">
                @Html.LabelFor(model => model.BusinessReason, new { @class = "disabled" })
                @Html.TextAreaFor(model => model.BusinessReason, new { @class = "md-textarea w-100" })
            </div>
            <div class="md-form">
                @Html.LabelFor((model) => model.SelectedApprover, new { @class = "mdb-main-label" })
                @Html.DropDownListFor((model) => model.SelectedApprover, Model.AllApprovers, new { @class = "mdb-select" })
            </div>
        </div>
        <button type="button" class="btn btn-primary d-none float-right" id="RequestAccessSubmit">Create Ticket</button>
        <button type="button" class="btn btn-secondary float-right" data-dismiss="modal">Close</button>
    </div>
}