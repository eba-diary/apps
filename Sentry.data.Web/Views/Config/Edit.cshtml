@model Sentry.data.Web.DatasetFileConfigsModel
@{
    ViewBag.Title = "Edit Data File Config";
}

<div>
    <a class="backToList" href="/Config/Dataset/@Model.DatasetId"><span class="glyphicon glyphicon-chevron-left"></span>Back to Dataset Configuration</a>
</div>


<h1>Basic Configuration</h1>

<hr/>

@{using (Html.BeginForm("DatasetFileConfigForm", "Config", FormMethod.Post))
{
        @Html.AntiForgeryToken()

        <style>
        </style>

        <div class="form-horizontal">
            @Html.DisplayFor((model) => ViewData.ModelState)

            @Html.HiddenFor(model => model.ConfigId, new { @name = "configId" })
            @Html.HiddenFor(model => model.ConfigFileName)
            @Html.HiddenFor(model => model.DatasetId)
            @Html.HiddenFor(model => model.SchemaId)

            <div class="form-group">
                @Html.LabelFor(m => m.ConfigFileName, htmlAttributes: new { @class = "control-label col-md-2" })
                <div class="col-sm-4">
                    @Html.DisplayFor(m => m.ConfigFileName, new { htmlAttributes = new { @class = "from-control-static" } })
                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(m => m.ConfigFileDesc, htmlAttributes: new { @class = "control-label col-md-2" })
                <div class="col-sm-9">
                    @Html.TextAreaFor(m => m.ConfigFileDesc, new { @class = "form-control ConfigFileDesc" })
                </div>
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.FileType, htmlAttributes: new { @class = "control-label col-md-2" })
                <div class="col-sm-4">
                    @if (Model.Security.ShowAdminControls)
                    {
                        @Html.DropDownListFor((model) => model.FileType, Model.AllDataFileTypes, new { @class = "form-control" })
                    }
                    else
                    {
                        @Html.HiddenFor(model => model.FileTypeId)
                        @Html.DropDownListFor(model => model.FileType, new SelectList(Model.AllDataFileTypes, "Text", "Text", Model.FileType), new { @disabled = "disabled", @readonly = "readonly", @class = "form-control " })

                    }
                </div>
            </div>
            @if (Model.Security.ShowAdminControls)
            {
                <div class="form-group">
                    @Html.LabelFor((model) => model.DatasetScopeTypeID, htmlAttributes: new { @class = "control-label col-md-2" })
                    <div class="col-sm-4">
                        @Html.DropDownListFor(model => model.DatasetScopeTypeID,
                   new SelectList(Model.AllDatasetScopeTypes, "Value", "Text", Model.DatasetScopeTypeID), new { @class = "form-control" })
                    </div>
                </div>
            }
            else
            {
                @Html.HiddenFor(model => model.DatasetScopeTypeID)
                <div class="form-group">
                    @Html.LabelFor((model) => model.DatasetScopeTypeID, htmlAttributes: new { @class = "control-label col-md-2" })
                    <div class="col-sm-4">
                        @Html.DropDownListFor(model => model.DatasetScopeTypeID,
                   new SelectList(Model.AllDatasetScopeTypes, "Value", "Text", Model.DatasetScopeTypeID), new { @disabled = "disabled", @readonly = "readonly", @class = "form-control" })
                    </div>
                </div>
            }

            @if (Model.Security.ShowAdminControls)
            {
                <div class="form-group">
                    @Html.LabelFor((model) => model.FileExtensionID, new { @class = "control-label col-md-2" })
                    <div class="col-md-4">
                        @Html.DropDownListFor(model => model.FileExtensionID,
                   new SelectList(Model.ExtensionList, "Value", "Text", Model.FileExtensionID), new { @class = "form-control" })
                    </div>
                </div>
            }
            else
            {
                @Html.HiddenFor(model => model.FileExtensionID)
                <div class="form-group">
                    @Html.LabelFor((model) => model.FileExtensionID, new { @class = "control-label col-md-2" })
                    <div class="col-md-4">
                        @Html.DropDownListFor(model => model.FileExtensionID,
                   new SelectList(Model.ExtensionList, "Value", "Text", Model.FileExtensionID), new { @disabled = "disabled", @readonly = "readonly", @class = "form-control" })
                    </div>
                </div>
            }

            <div class="form-group delimiter">
                @Html.LabelFor((model) => model.Delimiter, new { @class = "control-label col-md-2 optional" })
                <div class="col-md-10">
                    @Html.TextBoxFor((model) => model.Delimiter, new { @class = "form-control edit-dataset-row" })
                </div>
            </div>

            <div class="form-group fieldDescription delimiter delimiterDescription">
                <label class="control-label col-md-2"></label>
                <div class="col-md-10">
                    <span class="text-muted">
                        <em id="fileTypeInfo"></em>The character or set of characters used to delimit a file.  Common delimiters include; tab (\t), pipe (|), tilda (~).
                        <br />
                        Note: If your file is comma (,) delimited please choose the CSV file extension option. 
                    </span>
                </div>
            </div>

            <div class="form-group fileHasHeader">
                @Html.LabelFor((model) => model.HasHeader, new { @class = "control-label col-md-2 optional" })
                <div class="col-md-10">
                    @Html.CheckBoxFor((model) => model.HasHeader, new { htmlAttributes = new { @class = "form-control edit-dataset-row" } })
                </div>
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.CreateCurrentView, new { @class = "control-label col-md-2 optional" })
                <div class="col-md-1">
                    @Html.CheckBoxFor(model => model.CreateCurrentView, new { htmlAttributes = new { @class = "form-control edit-dataset-row" } })
                </div>
                @Html.Label("A view will be created filtering to data within latest file loaded into this schema", new { @class = "control-label col-md-9 optional text-muted", @style = "text-align: left" })
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.IncludedInSAS, new { @class = "control-label col-md-2 optional" })
                <div class="col-md-1">
                    @Html.CheckBoxFor(model => model.IncludedInSAS, new { htmlAttributes = new { @class = "form-control edit-dataset-row" } })
                </div>
                @Html.Label("Schema will be added to SAS after columns are defined", new { @class = "control-label col-md-4 optional text-muted", @style = "text-align: left" })
            </div>

            @if (Model.Security.ShowAdminControls)
            {
                <div class="form-group">
                    @Html.LabelFor((model) => model.CLA1396_NewEtlColumns, new { @class = "control-label col-md-2 optional" })
                    <div class="col-md-1">
                        @Html.CheckBoxFor(model => model.CLA1396_NewEtlColumns, new { htmlAttributes = new { @class = "form-control edit-dataset-row" } })
                    </div>
                    @Html.Label("Will trigger new ETL columns in consumption layer after syncing", new { @class = "control-label col-md-6 optional text-muted", @style = "text-align: left" })
                </div>
            }

            <hr />
            <div class="form-group">
                <span class="text-muted"><em>** Fields in <b>Bold</b> are Required</em></span>
            </div>
            <div class="form-group">
                <div>
                    <input type="submit" value="Save" class="btn btn-primary" />
                    <a class="btn btn-warning" href="/Config/Dataset/@Model.DatasetId">Cancel</a>
                </div>
            </div>
        </div>
        }
        }

        @section Scripts {
            <script>
                $(function () {
                    data.Config.CreateInit();
                });
            </script>
        }
